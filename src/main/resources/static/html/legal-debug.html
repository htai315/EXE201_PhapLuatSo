<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Legal Data</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-5">
    <h2>Debug Legal Data</h2>
    
    <div class="card mt-3">
        <div class="card-body">
            <h5>Statistics</h5>
            <div id="stats"></div>
        </div>
    </div>
    
    <div class="card mt-3">
        <div class="card-body">
            <h5>Documents</h5>
            <div id="documents"></div>
        </div>
    </div>
    
    <div class="card mt-3">
        <div class="card-body">
            <h5>Articles (Document ID: <input type="number" id="docId" value="1" style="width: 100px;">)</h5>
            <button class="btn btn-primary btn-sm" onclick="loadArticles()">Load</button>
            <div id="articles" class="mt-3"></div>
        </div>
    </div>
</div>

<script>
const token = localStorage.getItem('accessToken');

async function loadStats() {
    const res = await fetch('/api/legal/debug/stats', {
        headers: { 'Authorization': `Bearer ${token}` }
    });
    const data = await res.json();
    document.getElementById('stats').innerHTML = `
        <p>Total Documents: ${data.totalDocuments}</p>
        <p>Total Articles: ${data.totalArticles}</p>
    `;
}

async function loadDocuments() {
    const res = await fetch('/api/legal/documents', {
        headers: { 'Authorization': `Bearer ${token}` }
    });
    const docs = await res.json();
    document.getElementById('documents').innerHTML = docs.map(d => `
        <div class="border p-2 mb-2">
            <strong>ID: ${d.id}</strong> - ${d.documentName} (${d.totalArticles} điều)
        </div>
    `).join('');
}

async function loadArticles() {
    const docId = document.getElementById('docId').value;
    const res = await fetch(`/api/legal/debug/articles/${docId}`, {
        headers: { 'Authorization': `Bearer ${token}` }
    });
    const articles = await res.json();
    document.getElementById('articles').innerHTML = articles.map(a => `
        <div class="border p-2 mb-2">
            <strong>Điều ${a.articleNumber}</strong>: ${a.articleTitle || '(No title)'}
            <br><small>Length: ${a.contentLength} chars</small>
            <br><small>${a.contentPreview}</small>
        </div>
    `).join('');
}

loadStats();
loadDocuments();
</script>
</body>
</html>
